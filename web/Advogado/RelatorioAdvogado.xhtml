<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/Advogado/AdvogadoTemplate.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="titulo">Advogado - Relatórios</ui:define>
    <ui:define name="corpo">

        <h:form id="formRelatorio" class="formuser" enctype="multipart/form-data">
            <p:panel>
                <div class="d-sm-flex align-items-center justify-content-between mb-4">
                    <h1 class="h3 mb-0 text-gray-800">Relatórios</h1>
                </div>
                <div class="form-row">
                    <p:messages id="mensagem" showDetail="false" />
                </div>
                <div class="form-row">
                    <div class="form-group col-md-3">
                        <p:outputLabel for="dataInicio" value="Data de:" /><br />
                        <p:datePicker id="dataInicio" value="#{relatorioMb.dataInicio}" required="true"
                                      requiredMessage="Insira a data de inicio do periodo" />
                    </div>
                    <div class="form-group col-md-3">
                        <p:outputLabel for="dataFim" value="Data até:" /><br />
                        <p:datePicker id="dataFim" value="#{relatorioMb.dataFim}" required="true"
                                      requiredMessage="Insira a data de fim do periodo" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">

                        <p:outputLabel value="Tipo de relatório:" /><br />
                        <h:selectOneMenu value="#{relatorioMb.tipo}" class="form-control">
                            <f:selectItem itemLabel="Processos em aberto" itemValue="1" />
                            <f:selectItem itemLabel="Processos já encerrados" itemValue="2" />
                        </h:selectOneMenu>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <div style=" text-align: center">
                            <p:commandButton value="Gerar" actionListener="#{relatorioMb.gerarRelatorio}"
                                             style="font-size: medium" update="formRelatorio">
                                <p:confirm header="Gerar" message="Gerar relatório?" />
                            </p:commandButton>
                        </div>
                    </div>
                </div>

            </p:panel>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" />
                <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" />
            </p:confirmDialog>
            <p:dialog modal="true" id="divViewRelatorio" widgetVar="divViewRelatorio" width="90vw" height="90vh" closable="true" header="Relatorio"  >
                <p:outputPanel rendered="#{relatorioMb.previewRelatorio != null}" >
                    <iframe src="data:application/pdf;base64,#{relatorioMb.verRelatorioBase64(relatorioMb.previewRelatorio)}" width="100%" height="550" style="border: none;"></iframe>                        
                </p:outputPanel>  
            </p:dialog>  
        </h:form>
    </ui:define>
</ui:composition>